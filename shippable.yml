language: none

sudo: required

runtime:
  nodePool: shippable_shared_aarch64
  
build:
  pre_ci_boot:
    image_name: arm64v8/ubuntu
    image_tag: latest
    
  ci:
#   - lsb_release -a
   - sudo apt-get update
   - sudo add-apt-repository ppa:openjdk-r/ppa
   - sudo add-apt-repository universe
   - sudo printf "deb http:// artful main universe" >> /etc/apt/sources.list
   - sudo apt-get update
   - sudo apt-get remove openjdk-10-jre openjdk-10-jdk
   - sudo apt-get install -y openjdk-8-jre wget android-sdk-platform-tools android-sdk-build-tools
   - wget https://sh.rustup.rs -O rustup-init
   - sh rustup-init -y
   - chmod +x $HOME/.cargo/env && $HOME/.cargo/env
   - sudo /usr/bin/printf '\xfe\xed\xfe\xed\x00\x00\x00\x02\x00\x00\x00\x00\xe2\x68\x6e\x45\xfb\x43\xdf\xa4\xd9\x92\xdd\x41\xce\xb6\xb2\x1c\x63\x30\xd7\x92' > /etc/ssl/certs/java/cacerts
   - sudo /var/lib/dpkg/info/ca-certificates-java.postinst configure
   - sudo printf "2\n" | update-alternatives --config java
   - ./gradlew build
